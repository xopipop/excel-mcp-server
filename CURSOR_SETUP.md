# Настройка PC Control MCP Server для Cursor IDE

## Описание

Это руководство поможет вам настроить подключение PC Control MCP Server к Cursor IDE через Model Context Protocol (MCP).

## Требования

- Cursor IDE (последняя версия)
- Python 3.8 или выше
- Установленные зависимости проекта

## Быстрая установка

### 1. Установка зависимостей

```bash
# Создание виртуального окружения (рекомендуется)
python -m venv venv

# Активация виртуального окружения
# Linux/macOS:
source venv/bin/activate
# Windows:
venv\Scripts\activate

# Установка зависимостей
pip install -r requirements.txt
```

### 2. Настройка Cursor IDE

1. Откройте Cursor IDE
2. Перейдите в настройки (Settings → MCP или используйте `Ctrl+,`)
3. Найдите раздел "Model Context Protocol"
4. Нажмите "Add MCP Server"

### 3. Конфигурация MCP сервера

В проекте уже создан файл `mcp.json` с готовой конфигурацией. Cursor автоматически обнаружит этот файл.

Альтернативно, вы можете вручную добавить конфигурацию в настройках Cursor:

```json
{
  "pc-control": {
    "command": "python",
    "args": ["${workspaceFolder}/main.py"],
    "env": {
      "PYTHONPATH": "${workspaceFolder}",
      "PC_CONTROL_LOG_LEVEL": "INFO"
    }
  }
}
```

### 4. Запуск сервера

После настройки, Cursor автоматически запустит MCP сервер при открытии проекта.

Для ручного запуска:
1. Откройте Command Palette (`Ctrl+Shift+P`)
2. Введите "MCP: Restart Server"
3. Выберите "pc-control"

## Использование

### Доступные инструменты

После подключения сервера, в Cursor AI будут доступны следующие инструменты:

#### Системная информация
- `get_system_info` - Получить информацию о системе
- `get_hardware_info` - Информация об оборудовании
- `get_os_info` - Информация об ОС
- `execute_command` - Выполнить системную команду

#### Управление процессами
- `list_processes` - Список запущенных процессов
- `get_process_info` - Информация о процессе
- `kill_process` - Завершить процесс
- `start_process` - Запустить процесс

#### Файловые операции
- `read_file` - Прочитать файл
- `write_file` - Записать в файл
- `list_directory` - Список файлов в директории
- `search_files` - Поиск файлов

### Примеры использования в Cursor

В чате с AI вы можете использовать команды:

```
"Покажи информацию о системе"
"Какие процессы используют больше всего памяти?"
"Найди все Python файлы в текущей директории"
"Прочитай содержимое конфигурационного файла"
```

## Настройка безопасности

### Ограничение доступа к путям

Отредактируйте `config/security.yaml`:

```yaml
file_operations:
  allowed_paths:
    - "${workspaceFolder}"
    - "${home}/Documents"
  blocked_paths:
    - "/etc"
    - "/System"
    - "C:\\Windows\\System32"
```

### Ограничение команд

```yaml
command_execution:
  allowed_commands:
    - "ls"
    - "dir"
    - "python"
    - "node"
  blocked_commands:
    - "rm"
    - "del"
    - "format"
```

## Отладка

### Просмотр логов

Логи сохраняются в:
- Linux/macOS: `~/.pc_control_mcp/logs/`
- Windows: `%USERPROFILE%\.pc_control_mcp\logs\`

### Проверка подключения

1. Откройте Output Panel в Cursor (`View → Output`)
2. Выберите "MCP" в выпадающем списке
3. Проверьте статус подключения

### Частые проблемы

**Проблема**: Сервер не запускается
- Убедитесь, что Python установлен и доступен в PATH
- Проверьте, что все зависимости установлены
- Проверьте права доступа к файлам

**Проблема**: Ошибки безопасности
- Проверьте настройки в `config/security.yaml`
- Убедитесь, что пути правильно настроены

**Проблема**: Команды не выполняются
- Проверьте логи на наличие ошибок
- Убедитесь, что команда разрешена в конфигурации

## Дополнительные настройки

### Переменные окружения

Вы можете настроить поведение сервера через переменные окружения:

- `PC_CONTROL_LOG_LEVEL` - Уровень логирования (DEBUG, INFO, WARNING, ERROR)
- `PC_CONTROL_CONFIG_PATH` - Путь к директории с конфигурацией
- `PC_CONTROL_MAX_FILE_SIZE` - Максимальный размер файла для чтения (в байтах)

### Настройка прокси

Если вы работаете через прокси, добавьте в `mcp.json`:

```json
"env": {
  "HTTP_PROXY": "http://proxy.company.com:8080",
  "HTTPS_PROXY": "http://proxy.company.com:8080"
}
```

## Поддержка

При возникновении проблем:
1. Проверьте логи сервера
2. Обратитесь к документации API в `docs/API.md`
3. Создайте issue в репозитории проекта

## Расширенная конфигурация

### Использование профилей

В файле `.cursor/mcp-config.json` доступны различные профили для разных сценариев использования:

- **production** - для повседневной работы с включенной безопасностью
- **development** - для разработки с расширенным логированием
- **testing** - для тестирования функциональности

Переключение между профилями в Cursor:
1. Command Palette → "MCP: Select Profile"
2. Выберите нужный профиль

### Алиасы команд

Для удобства настроены короткие алиасы:
- `sys` → `get_system_info`
- `ps` → `list_processes`
- `ls` → `list_directory`
- `cat` → `read_file`
- `exec` → `execute_command`

### Быстрые действия (Shortcuts)

Предустановленные комбинации инструментов:
- **System Status** - полная информация о системе
- **Quick File Search** - быстрый поиск файлов

Использование в Cursor:
```
"Выполни System Status"
"Используй Quick File Search для поиска *.py файлов"
```

### Мониторинг и метрики

Сервер автоматически собирает метрики:
- Использование CPU
- Использование памяти
- Дисковое пространство
- Сетевой трафик

Просмотр метрик:
```
"Покажи метрики системы за последний час"
"Какая средняя загрузка CPU?"
```

### Кастомизация безопасности

Вы можете настроить дополнительные ограничения в `.cursor/mcp-config.json`:

```json
"security": {
  "allowedPaths": [
    "${workspaceFolder}",
    "/custom/safe/path"
  ],
  "customRules": {
    "maxFileSize": "100MB",
    "maxProcesses": 10,
    "allowNetworkAccess": false
  }
}
```